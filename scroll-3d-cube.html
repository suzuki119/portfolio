<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>スクロール連動3D立方体</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 300vh;
            overflow-x: hidden;
        }

        .container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            pointer-events: none;
        }

        #canvas {
            display: block;
        }

        .info {
            position: fixed;
            top: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.9);
            padding: 20px 40px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            text-align: center;
            z-index: 10;
        }

        .info h1 {
            font-size: 28px;
            color: #667eea;
            margin-bottom: 10px;
        }

        .info p {
            font-size: 16px;
            color: #555;
        }

        .scroll-indicator {
            position: fixed;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            font-size: 18px;
            text-align: center;
            animation: bounce 2s infinite;
            z-index: 10;
        }

        .scroll-indicator::after {
            content: '↓';
            display: block;
            font-size: 30px;
            margin-top: 10px;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateX(-50%) translateY(0);
            }
            40% {
                transform: translateX(-50%) translateY(-10px);
            }
            60% {
                transform: translateX(-50%) translateY(-5px);
            }
        }

        .progress-bar {
            position: fixed;
            top: 0;
            left: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            z-index: 100;
            transition: width 0.1s ease;
        }
    </style>
</head>
<body>
    <div class="progress-bar" id="progressBar"></div>
    
    <div class="info">
        <h1>スクロール連動3D立方体</h1>
        <p>スクロールして立方体を回転させてください</p>
    </div>

    <div class="container">
        <canvas id="canvas"></canvas>
    </div>

    <div class="scroll-indicator">
        スクロールしてみてください
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        // シーンのセットアップ
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ 
            canvas: document.getElementById('canvas'),
            antialias: true,
            alpha: true
        });

        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

        // 立方体の作成
        const geometry = new THREE.BoxGeometry(2, 2, 2);
        
        // マルチマテリアル（各面に異なる色）
        const materials = [
            new THREE.MeshStandardMaterial({ color: 0xff6b6b, metalness: 0.3, roughness: 0.4 }),
            new THREE.MeshStandardMaterial({ color: 0x4ecdc4, metalness: 0.3, roughness: 0.4 }),
            new THREE.MeshStandardMaterial({ color: 0xffe66d, metalness: 0.3, roughness: 0.4 }),
            new THREE.MeshStandardMaterial({ color: 0x95e1d3, metalness: 0.3, roughness: 0.4 }),
            new THREE.MeshStandardMaterial({ color: 0xf38181, metalness: 0.3, roughness: 0.4 }),
            new THREE.MeshStandardMaterial({ color: 0xaa96da, metalness: 0.3, roughness: 0.4 })
        ];

        const cube = new THREE.Mesh(geometry, materials);
        
        // 初期状態でY軸に45度傾ける
        cube.rotation.y = Math.PI / 4; // 45度 = π/4 ラジアン
        
        scene.add(cube);

        // エッジの追加
        const edges = new THREE.EdgesGeometry(geometry);
        const line = new THREE.LineSegments(
            edges, 
            new THREE.LineBasicMaterial({ color: 0xffffff, linewidth: 2 })
        );
        cube.add(line);

        // ライトの設定
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
        scene.add(ambientLight);

        const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
        directionalLight.position.set(5, 5, 5);
        scene.add(directionalLight);

        const directionalLight2 = new THREE.DirectionalLight(0xffffff, 0.4);
        directionalLight2.position.set(-5, -5, -5);
        scene.add(directionalLight2);

        camera.position.z = 5;

        // スクロール処理
        let scrollY = 0;

        window.addEventListener('scroll', () => {
            scrollY = window.scrollY;
            
            // プログレスバーの更新
            const scrollPercent = (scrollY / (document.body.scrollHeight - window.innerHeight)) * 100;
            document.getElementById('progressBar').style.width = scrollPercent + '%';
        });

        // アニメーションループ
        function animate() {
            requestAnimationFrame(animate);

            // スクロール量に基づいてX軸のみ回転
            cube.rotation.x = scrollY * 0.001;

            // 微妙な浮遊効果
            cube.position.y = Math.sin(Date.now() * 0.001) * 0.1;

            renderer.render(scene, camera);
        }

        animate();

        // リサイズ処理
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        // スクロールインジケーターを隠す
        window.addEventListener('scroll', () => {
            const indicator = document.querySelector('.scroll-indicator');
            if (window.scrollY > 100) {
                indicator.style.opacity = '0';
                indicator.style.transition = 'opacity 0.5s';
            } else {
                indicator.style.opacity = '1';
            }
        }, { once: false });
    </script>
</body>
</html>
